$(document).ready(function(){commodity_mark()});function commodity_addYgPrice(a){$.ajax({type:"POST",url:"/commodity/getPrices.sc",dataType:"json",data:"cNos="+a,success:function(f){var c=0;for(var b=0;b<f.length;b++){c=f[b];var e=c.active?c.active:c.sellPrice;$(".price_no"+c.no+" i").html(e).parent().siblings(".ico_discount").find("i").html(c.discount);var g=c.discount;g=g==10?10+" ":g;$(".discount_no"+c.no).html(g)}}})}function commodity_mark(h){var e=[];var g=false;var i=false;var b=false,d=false,f=false,c=false;if(h){strProductNos=h.split(",");e=strProductNos;g=true}else{$("sup.salepic2").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);i=true}});$("sup.salepic").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);g=true}});$(".cmdtyPrice").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);b=true}})}if($("#newtopicbd")[0]){d=true;if($(".tpc_lst_module3,.tpc_lst_module2").length>0){c=true}}var a=e.join(";");if(e.length>0){if(d){commodity_addYgPrice(a)}$.post("/api/mark_new.jhtml",{cNos:a},function(o){if(o!=null&&o.length>0){var n=function(v){var q=o[v],p=q.no,B=q.activePrice,D=q.discount;if(B&&!d){var F=$(".price_no"+p);F.find("i").html(B);F.siblings(".ico_discount").find("i").html(D)}if(d&&c){D=D==10?10+" ":D;$("i.discount_no"+p).html(D)}if(!i&&!g){return}var y=q.marks;if(q.memberPrice){$("sup.mark_small_"+p).html("<em class='saleActiveRemark memberprice'>会员尊享<strong>&yen;"+q.memberPrice+"</strong></em>")}if(y!=null&&y!=""&&y.length>0&&!q.memberPrice){for(var s=0;s<y.length;s++){var u=y[s];var t=u.mark;var E=u.value;var A=u.lessSize;if(t==null&&t==""){continue}if(t=="sys"){if(E=="out"){if(i){$("sup.mark_big_"+p).html('<em class="markSoldOut"></em>').addClass("markSoldOut_sup")}if(g){$("sup.mark_small_"+p).html('<em class="markSoldOut"></em>').addClass("markSoldOut_sup")}}if(E=="less"){if(g){if(A&&A!=undefined){A="尺码："+A;$("sup.mark_small_"+p).html('<em class="markLess saleActiveRemark" >'+A+"</em>")}else{$("sup.mark_small_"+p).html('<em class="markLess saleActiveRemark"></em>')}}}}else{if(t=="promotion"&&g&&typeof(activeTopic)!="boolean"){var r=u.type;var w="";if(u.uLevel){w=u.uLevel+" "}if(r==1){if(u.loopLimit!=null&&u.loopLimit==0){$("sup.mark_small_"+p).html("<em class='saleActiveRemark mj'>"+w+"每满"+u.full+"<strong>减"+E+"</strong></em>")}else{$("sup.mark_small_"+p).html("<em class='saleActiveRemark mj'>"+w+"满"+u.full+"<strong>减"+E+"</strong></em>")}}else{if(r==2){$("sup.mark_small_"+p).html("<em class='saleActiveRemark xsq'>"+w+"限时抢<strong>&yen;"+E+"</strong></em>")}else{if(r==8){$("sup.mark_small_"+p).html("<em class='saleActiveRemark xsq'>"+w+"加价购</em>")}else{if(r==9){$("sup.mark_small_"+p).html("<em class='saleActiveRemark xsq'>"+w+"立减<strong>&yen;"+E+"</strong></em>")}else{if(r==10||r==11){var x=[];var z="折";var C=u.specMark;if(r==11){z="元"}if(C){$.each(C,function(H,G){x.push(G.number+"件"+G.value+z)})}$("sup.mark_small_"+p).html("<em class='saleActiveRemark mj'>"+w+x.join("，")+"</em>")}else{if(r==13){$("sup.mark_small_"+p).html("<em class='saleActiveRemark mzk'>"+w+"满"+u.full+"<strong>享"+E+"折</strong></em>")}else{if(r==14||r==15){$("sup.mark_small_"+p).html("<em class='saleActiveRemark xsq'>"+w+"送赠品</em>")}else{if(r==17){$("sup.mark_small_"+p).html("<em class='saleActiveRemark mj'>"+w+u.full+"件套装"+u.value+"元</em>")}else{if(r==18){$("sup.mark_small_"+p).html("<em class='saleActiveRemark xsq'>预约购买</em>")}}}}}}}}}}else{if(t=="ordinary"){if(i){$("sup.mark_big_"+p).html('<em class="markNew saleActiveRemark"></em>')}if(g){$("sup.mark_small_"+p).html('<em class="markNew saleActiveRemark"></em>')}}}}}}};var l=30,k=0,j=o.length;var m=function(){k++;for(var p=(k-1)*l;p<l*k&&p<j;p++){n(p)}if(p<j){setTimeout(m,3000)}};m(k)}},"json")}};